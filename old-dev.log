[2024-08-11 18:15:50] app.INFO:    OrderProcessingSideEffect::Redis::{"hexists":["zoodfood:feature-toggles","rate_limit"]}::    [] []
[2024-08-11 18:16:01] request.INFO: Matched route "vms_api_v1_order_accept". {"route_parameters":{"_controller":"BodoFood\\ApiBundle\\Controller\\VMS\\v1\\OrderController::acceptAction","_format":"json","domain":"api.snappfood.local","_route":"vms_api_v1_order_accept"},"request_uri":"http://api.snappfood.local/vms/v1/order/accept"} []
[2024-08-11 18:16:01] security.DEBUG: Checking for guard authentication credentials. {"firewall_key":"frontend","authenticators":2} []
[2024-08-11 18:16:01] security.DEBUG: Calling getCredentials() on guard configurator. {"firewall_key":"frontend","authenticator":"BodoFood\\OAuth2Bundle\\Security\\OAuth2GuardAuthenticator"} []
[2024-08-11 18:16:01] app.INFO:    OrderProcessingSideEffect::Redis::{"get":["zoodfood_sess_c97c434aa9409c4804a34b029361d43c"]}::    [] []
[2024-08-11 18:16:01] security.DEBUG: Calling getCredentials() on guard configurator. {"firewall_key":"frontend","authenticator":"BodoFood\\Bundle\\Security\\SnappFoodGuardAuthenticator"} []
[2024-08-11 18:16:01] security.INFO: Populated the TokenStorage with an anonymous Token. [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.request" to listener "Liip\FunctionalTestBundle\EventListener\ExceptionListener::clearLastException". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.request" to listener "Liip\FunctionalTestBundle\Validator\DataCollectingValidator::clearLastErrors". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.request" to listener "Symfony\Component\HttpKernel\EventListener\DebugHandlersListener::configure". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.request" to listener "Symfony\Component\HttpKernel\EventListener\ProfilerListener::onKernelRequest". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.request" to listener "Symfony\Component\HttpKernel\EventListener\ValidateRequestListener::onKernelRequest". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.request" to listener "Bugsnag\BugsnagBundle\EventListener\BugsnagListener::onKernelRequest". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.request" to listener "Nelmio\CorsBundle\EventListener\CorsListener::onKernelRequest". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.request" to listener "BodoFood\OAuth2Bundle\EventListener\OAuth2Listener::onKernelRequest". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.request" to listener "BodoFood\OAuth2Bundle\EventListener\SessionListener::onKernelRequest". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.request" to listener "Symfony\Bundle\FrameworkBundle\EventListener\SessionListener::onKernelRequest". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.request" to listener "Symfony\Component\HttpKernel\EventListener\FragmentListener::onKernelRequest". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.request" to listener "Symfony\Component\HttpKernel\EventListener\RouterListener::onKernelRequest". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.request" to listener "BodoFood\Bundle\EventListener\LocaleListener::onKernelRequest". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.request" to listener "Symfony\Component\HttpKernel\EventListener\LocaleListener::onKernelRequest". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.request" to listener "Symfony\Component\HttpKernel\EventListener\TranslatorListener::onKernelRequest". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.request" to listener "Symfony\Component\Security\Http\Firewall::onKernelRequest". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.request" to listener "Sentry\SentryBundle\EventListener\RequestListener::onKernelRequest". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.request" to listener "Sentry\SentryBundle\EventListener\SubRequestListener::onKernelRequest". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.request" to listener "BodoFood\APMBundle\Collectors\Symfony\SymfonyEventLogger::onKernelEvent". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.request" to listener "Symfony\Bundle\AsseticBundle\EventListener\RequestListener::onKernelRequest". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.controller" to listener "Sentry\SentryBundle\EventListener\RequestListener::onKernelController". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.controller" to listener "Symfony\Bundle\FrameworkBundle\DataCollector\RouterDataCollector::onKernelController". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.controller" to listener "BodoFood\UserBundle\EventListener\AutoAuthorizationListener::onKernelController". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.controller" to listener "BodoFood\ApiBundle\EventListener\ApiReqLoggerListener::onKernelController". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.controller" to listener "BodoFood\Bundle\EventListener\OnKernelRequestHandler::onKernelController". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.controller" to listener "Symfony\Component\HttpKernel\DataCollector\RequestDataCollector::onKernelController". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.controller" to listener "Sensio\Bundle\FrameworkExtraBundle\EventListener\ControllerListener::onKernelController". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.controller" to listener "Sensio\Bundle\FrameworkExtraBundle\EventListener\ParamConverterListener::onKernelController". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.controller" to listener "Sensio\Bundle\FrameworkExtraBundle\EventListener\HttpCacheListener::onKernelController". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.controller" to listener "Sensio\Bundle\FrameworkExtraBundle\EventListener\SecurityListener::onKernelController". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.controller" to listener "BodoFood\BackendBundle\EventListener\ActionLockerListener::onBeforeAction". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.controller" to listener "BodoFood\APMBundle\EventListener\APMKernelListener::onKernelController". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.controller" to listener "BodoFood\APMBundle\Collectors\Symfony\SymfonyEventLogger::onKernelEvent". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.controller" to listener "BodoFood\BackendBundle\EventListener\AuditLogHandler::onKernelController". [] []
[2024-08-11 18:16:01] event.DEBUG: Notified event "kernel.controller" to listener "Sensio\Bundle\FrameworkExtraBundle\EventListener\TemplateListener::onKernelController". [] []
[2024-08-11 18:16:03] app.INFO:    OrderProcessingSideEffect::RabbitMq::{"passive":false,"durable":true,"auto_delete":false,"internal":false,"nowait":false,"arguments":null,"ticket":null,"declare":true,"name":"vendor_ping_generator","type":"direct"}::    [] []
[2024-08-11 18:16:04] app.INFO:    OrderProcessingSideEffect::Redis::{"hexists":["zoodfood:feature-toggles","doctrine"]}::    [] []
[2024-08-11 18:16:14] app.INFO:    OrderProcessingSideEffect::Business::{"Flow":{"DependenciesLoaded":true},"Deep":{"OrderId":"40870","VendorId":"35975"}}::BodoFood\OrderBundle\Services\OrderProcessing::loadOrderDependencies::    [] []
[2024-08-11 18:16:16] app.INFO:    OrderProcessingSideEffect::Redis::{"get":["express_minimum_delivery_distance_1"]}::    [] []
[2024-08-11 18:16:17] app.INFO:    OrderProcessingSideEffect::Redis::::    [] []
[2024-08-11 18:16:17] app.INFO:    OrderProcessingSideEffect::Redis::{"getbit":["user_favorite_vendors:5479682",35975]}::    [] []
[2024-08-11 18:16:17] app.INFO:    OrderProcessingSideEffect::Redis::{"exists":["user_favorite_vendors:5479682"]}::    [] []
[2024-08-11 18:16:20] app.INFO:    OrderProcessingSideEffect::Redis::{"get":["reviewStars_35975"]}::    [] []
[2024-08-11 18:16:20] app.INFO:    OrderProcessingSideEffect::Redis::{"set":["reviewStars_35975","{\"one\":0,\"two\":0,\"three\":0,\"four\":0,\"five\":0}"]}::    [] []
[2024-08-11 18:16:20] app.INFO:    OrderProcessingSideEffect::Redis::{"smembers":["stock_reserver_reservations:order-40870"]}::    [] []
[2024-08-11 18:16:20] app.INFO:    OrderProcessingSideEffect::Business::{"Flow":{"BasketCreated":false},"Deep":{"OrderId":40870,"VendorId":35975,"BasketId":"basket-order-40870"}}::BodoFood\OrderBundle\Services\OrderProcessing::accept::    [] []
[2024-08-11 18:16:20] app.INFO:    OrderProcessingSideEffect::Business::{"Flow":{"Status":"Accepted"},"Deep":{"OrderId":40870,"VendorId":35975}}::BodoFood\OrderBundle\Services\OrderProcessing::accept::    [] []
[2024-08-11 18:16:20] app.INFO:    OrderProcessingSideEffect::Business::{"Flow":{"UserAddressSet":true},"Deep":{"OrderId":40870,"VendorId":35975,"UserAddressSet":"\u062a\u0647\u0631\u0627\u0646\u060c \u0645\u06cc\u0631\u062f\u0627\u0645\u0627\u062f\u060c \u067e\u0648\u0631\u06cc \u0633\u0644\u0637\u0627\u0646\u06cc\u060c \u0646\u0627\u0645\u06cc \u0628\u0639\u062f \u0627\u0632 \u0622\u0642\u0627\u0632\u0627\u062f\u0647 \u0641\u0631\u062f\u060c  \u0645\u06cc\u0631\u062f\u0627\u0645\u0627\u062f"}}::BodoFood\OrderBundle\Services\OrderProcessing::accept::    [] []
[2024-08-11 18:16:20] app.INFO:    OrderProcessingSideEffect::Business::{"Flow":{"DeltaOrderPriceSet":true},"Deep":{"OrderId":"40870","VendorId":"35975","DeltaOrderPrice":50}}::BodoFood\OrderBundle\Services\OrderProcessing::accept::    [] []
[2024-08-11 18:16:20] app.CRITICAL: vms_api_v1_order_accept: L-a5ed6-0478-46 order-processing error {"orderId":40870,"ex":"[object] (TypeError(code: 0): Argument 4 passed to BodoFood\\OrderBundle\\Services\\OrderProcessing::handleVendorUserAddress() must be of the type string, null given, called in /var/www/html/src/BodoFood/OrderBundle/Services/OrderProcessing.php on line 2484 at /var/www/html/src/BodoFood/OrderBundle/Services/OrderProcessing.php:1823)","trace":"#0 /var/www/html/src/BodoFood/OrderBundle/Services/OrderProcessing.php(2484): BodoFood\\OrderBundle\\Services\\OrderProcessing->handleVendorUserAddress(35975, 10001656, Object(BodoFood\\OrderBundle\\Entity\\Order), NULL, '3500', Object(BodoFood\\UserBundle\\Entity\\UserAddress), Object(Proxies\\__CG__\\BodoFood\\VendorBundle\\Entity\\Vendor))\n#1 /var/www/html/src/BodoFood/OrderBundle/Services/OrderService.php(3476): BodoFood\\OrderBundle\\Services\\OrderProcessing->accept(Object(BodoFood\\OrderBundle\\Entity\\Order), Array, NULL, 35000, 1, NULL, NULL, 'comment', '10001656', NULL, '3500', '45', 1, '1200', 1, '50', true, true, NULL, Array, NULL, 0, '15', NULL, NULL)\n#2 /var/www/html/src/BodoFood/ApiBundle/Controller/VMS/v1/OrderController.php(186): BodoFood\\OrderBundle\\Services\\OrderService->acceptOrder('40870', 'comment', '10001656', NULL, '3500', '45', '1200', '50', '15', 'VMS')\n#3 [internal function]: BodoFood\\ApiBundle\\Controller\\VMS\\v1\\OrderController->acceptAction(Object(Symfony\\Component\\HttpFoundation\\Request))\n#4 /var/www/html/vendor/symfony/symfony/src/Symfony/Component/HttpKernel/HttpKernel.php(144): call_user_func_array(Array, Array)\n#5 /var/www/html/vendor/symfony/symfony/src/Symfony/Component/HttpKernel/HttpKernel.php(64): Symfony\\Component\\HttpKernel\\HttpKernel->handleRaw(Object(Symfony\\Component\\HttpFoundation\\Request), 1)\n#6 /var/www/html/vendor/symfony/symfony/src/Symfony/Component/HttpKernel/DependencyInjection/ContainerAwareHttpKernel.php(69): Symfony\\Component\\HttpKernel\\HttpKernel->handle(Object(Symfony\\Component\\HttpFoundation\\Request), 1, true)\n#7 /var/www/html/vendor/symfony/symfony/src/Symfony/Component/HttpKernel/Kernel.php(185): Symfony\\Component\\HttpKernel\\DependencyInjection\\ContainerAwareHttpKernel->handle(Object(Symfony\\Component\\HttpFoundation\\Request), 1, true)\n#8 /var/www/html/web/app_dev.php(27): Symfony\\Component\\HttpKernel\\Kernel->handle(Object(Symfony\\Component\\HttpFoundation\\Request))\n#9 {main}"} []
[2024-08-11 18:16:20] app.INFO:    OrderProcessingSideEffect::Redis::{"smembers":["stock_reserver_reservations:basket-order-40870"]}::    [] []
[2024-08-11 18:16:20] app.INFO:    OrderProcessingSideEffect::Redis::{"smembers":["stock_reserver_reservations:order-40870"]}::    [] []
[2024-08-11 18:16:20] vms_notification_sender.INFO: vms_api_v1_order_accept: L-a5ed6-0478-46 Error in accepting order : {"order_id":"40870","tracking_identifier":"VMS","result":false} [] []
[2024-08-11 18:16:20] app.DEBUG: vms_api_v1_order_accept: L-a5ed6-0478-46 customlog request {"url":"/vms/v1/order/accept","body":{"orderId":"40870","deliveryPrice":"3500","packingPrice":"1200","addressId":"10001656","deliveryTime":"45","delta":"50","comment":"comment","riderPickupTime":"15","deviceType":"VMS"},"content":"","header":{"content-length":["1074"],"content-type":["multipart/form-data; boundary=--------------------------917982878320923521993599"],"connection":["keep-alive"],"accept-encoding":["gzip, deflate, br"],"host":["api.snappfood.local"],"postman-token":["e20fffa5-27ed-4cde-ac36-8d213e5af21e"],"cache-control":["no-cache"],"accept":["*/*"],"user-agent":["PostmanRuntime/7.37.3"],"x-php-ob-level":[1]},"cookie":[]} []
[2024-08-11 18:16:20] app.DEBUG: vms_api_v1_order_accept: L-a5ed6-0478-46 customlog response {"content":"{\"status\":true,\"data\":{\"result\":false}}","header":{"cache-control":["no-cache"],"content-type":["application/json"]}} []
[2024-08-11 18:16:21] app.INFO:    OrderProcessingSideEffect::Redis::{"setex":["zoodfood_sess_c97c434aa9409c4804a34b029361d43c",604800,"_sf2_attributes|a:1:{s:15:\"basket-identity\";N;}_sf2_flashes|a:0:{}_sf2_meta|a:3:{s:1:\"u\";i:1723387561;s:1:\"c\";i:1723387561;s:1:\"l\";s:7:\"2592000\";}"]}::    [] []
[2024-08-11 18:16:21] event.DEBUG: Notified event "kernel.response" to listener "BodoFood\BackendBundle\EventListener\AuditLogHandler::onKernelResponse". [] []
[2024-08-11 18:16:21] event.DEBUG: Notified event "kernel.response" to listener "BodoFood\APMBundle\Collectors\Symfony\SymfonyEventLogger::onKernelEvent". [] []
[2024-08-11 18:16:21] event.DEBUG: Notified event "kernel.response" to listener "BodoFood\Bundle\EventListener\OnKernelRequestHandler::onKernelResponse". [] []
[2024-08-11 18:16:21] event.DEBUG: Notified event "kernel.response" to listener "Symfony\Component\HttpKernel\EventListener\ResponseListener::onKernelResponse". [] []
[2024-08-11 18:16:21] event.DEBUG: Notified event "kernel.response" to listener "Symfony\Component\Security\Http\RememberMe\ResponseListener::onKernelResponse". [] []
[2024-08-11 18:16:21] event.DEBUG: Notified event "kernel.response" to listener "Sensio\Bundle\FrameworkExtraBundle\EventListener\HttpCacheListener::onKernelResponse". [] []
[2024-08-11 18:16:21] event.DEBUG: Notified event "kernel.response" to listener "Symfony\Component\HttpKernel\EventListener\ProfilerListener::onKernelResponse". [] []
[2024-08-11 18:16:21] event.DEBUG: Notified event "kernel.response" to listener "Symfony\Component\HttpKernel\EventListener\SaveSessionListener::onKernelResponse". [] []
[2024-08-11 18:16:21] event.DEBUG: Notified event "kernel.response" to listener "Symfony\Component\HttpKernel\EventListener\StreamedResponseListener::onKernelResponse". [] []
[2024-08-11 18:16:21] event.DEBUG: Notified event "kernel.finish_request" to listener "Sentry\SentryBundle\EventListener\SubRequestListener::onKernelFinishRequest". [] []
[2024-08-11 18:16:21] event.DEBUG: Notified event "kernel.finish_request" to listener "Symfony\Component\HttpKernel\EventListener\LocaleListener::onKernelFinishRequest". [] []
[2024-08-11 18:16:21] event.DEBUG: Notified event "kernel.finish_request" to listener "Symfony\Component\HttpKernel\EventListener\TranslatorListener::onKernelFinishRequest". [] []
[2024-08-11 18:16:21] event.DEBUG: Notified event "kernel.finish_request" to listener "Symfony\Component\HttpKernel\EventListener\RouterListener::onKernelFinishRequest". [] []
[2024-08-11 18:16:21] event.DEBUG: Notified event "kernel.finish_request" to listener "Symfony\Component\Security\Http\Firewall::onKernelFinishRequest". [] []
[2024-08-11 18:16:21] event.DEBUG: Notified event "kernel.finish_request" to listener "BodoFood\APMBundle\Collectors\Symfony\SymfonyEventLogger::onKernelEvent". [] []
[2024-08-11 18:16:21] app.INFO:    OrderProcessingSideEffect::Redis::{"hexists":["zoodfood:feature-toggles","delayed_order_queue"]}::    [] []
[2024-08-11 18:16:21] event.INFO: An exception was thrown while getting the uncalled listeners. {"exception":"[object] (Symfony\\Component\\DependencyInjection\\Exception\\InactiveScopeException(code: 0): You cannot create a service (\"request\") of an inactive scope (\"request\"). at /var/www/html/app/cache/dev/appDevDebugProjectContainer.php:46244)"} []
[2024-08-11 18:16:21] event.DEBUG: Notified event "kernel.terminate" to listener "Bugsnag\BugsnagBundle\EventListener\BugsnagShutdown::onTerminate". [] []
[2024-08-11 18:16:21] event.DEBUG: Notified event "kernel.terminate" to listener "Symfony\Bundle\SwiftmailerBundle\EventListener\EmailSenderListener::onTerminate". [] []
[2024-08-11 18:16:21] event.DEBUG: Notified event "kernel.terminate" to listener "BodoFood\APMBundle\Collectors\Symfony\SymfonyEventLogger::onKernelEvent". [] []
[2024-08-11 18:16:21] event.DEBUG: Notified event "kernel.terminate" to listener "BodoFood\APMBundle\EventListener\APMKernelListener::onKernelTerminate". [] []
[2024-08-11 18:16:21] event.DEBUG: Notified event "kernel.terminate" to listener "Symfony\Component\HttpKernel\EventListener\ProfilerListener::onKernelTerminate". [] []
